<!DOCTYPE html>
<html lang="fr">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<meta name="description" content="Open the door project from @ThomFree on Github">
	<meta name="author" content="Thomas Hedoux">
	<link rel="shortcut icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAN2AAADdgF91YLMAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAARFQTFRF////usbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMz9zlusbMz9zlusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMz9zlu8fOusbMusbMusbMusbMusbMusbMQV5yQl9zRGB1SGR3TWh7UWx9VW+BWXOEXXeIYHqLZ3+Ob4aUcoiWeI2be5CegZWihZikhZilip2ojaCrkqSvlqexn664o7O7prW9p7a+qLa+rL3JrrzDsL7EtMTPtcHIuMTLuMXMusbMvcnQz9zlWK62yAAAADZ0Uk5TAAEFBg4PHB4fICEtPk9RUlNUVGBgcXKCg4WGh5OUpLW2uLm6u7/FxsfP0NfY4ODn6Ovs7fT8wZPr2gAAAVdJREFUeNrt29dOAkEUgOG1oKuAC3bACnaxIWDvvXccff8HUVlikLguBGaOF/9/v7NfcpK5mmNZ9dbWMzJpSdUaHppXSqVFft4cGpjOqWICgGDfaFZ9ZxjwOfRl9SODgIA7dCUCKBt6RUu9/nU3dOgVvb37t9jQoRsEBMLDaeWXLkBLaHAmp6pIB6Ap2D+WVVWmAzCrakgHYAEAgFoArw8ePRsC3OU92gMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6AW8FCQAt5fnJ0cH+7vbm+v5GwnAYdn5AEQApztbG2uSgK8KT/fXVxdnx49cRAAAAAAAAAAAAAAAAAAAAAAAAAAA/BeA+ON29gsAANABmJMGWO1dsfEVSYCrcKpSaF54tJ1Y8m+FiZVP24knM14AY1u3duR3hdm9445IPJWRBJQUidSqJMBVREsKKUCxzmhiYqqO7z8AWJdsq47RhMQAAAAASUVORK5CYII=" />

	<title>Open The Door - Accueil</title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
	<link href="./css/style.css" rel="stylesheet">

</head>
<body>
	
	<header>
		<nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark" style="padding-left: 15px;">
			<a class="navbar-brand" href="/" >
				<img height="48" width="48" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAN2AAADdgF91YLMAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAARFQTFRF////usbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMz9zlusbMz9zlusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMusbMz9zlu8fOusbMusbMusbMusbMusbMusbMQV5yQl9zRGB1SGR3TWh7UWx9VW+BWXOEXXeIYHqLZ3+Ob4aUcoiWeI2be5CegZWihZikhZilip2ojaCrkqSvlqexn664o7O7prW9p7a+qLa+rL3JrrzDsL7EtMTPtcHIuMTLuMXMusbMvcnQz9zlWK62yAAAADZ0Uk5TAAEFBg4PHB4fICEtPk9RUlNUVGBgcXKCg4WGh5OUpLW2uLm6u7/FxsfP0NfY4ODn6Ovs7fT8wZPr2gAAAVdJREFUeNrt29dOAkEUgOG1oKuAC3bACnaxIWDvvXccff8HUVlikLguBGaOF/9/v7NfcpK5mmNZ9dbWMzJpSdUaHppXSqVFft4cGpjOqWICgGDfaFZ9ZxjwOfRl9SODgIA7dCUCKBt6RUu9/nU3dOgVvb37t9jQoRsEBMLDaeWXLkBLaHAmp6pIB6Ap2D+WVVWmAzCrakgHYAEAgFoArw8ePRsC3OU92gMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6AW8FCQAt5fnJ0cH+7vbm+v5GwnAYdn5AEQApztbG2uSgK8KT/fXVxdnx49cRAAAAAAAAAAAAAAAAAAAAAAAAAAA/BeA+ON29gsAANABmJMGWO1dsfEVSYCrcKpSaF54tJ1Y8m+FiZVP24knM14AY1u3duR3hdm9445IPJWRBJQUidSqJMBVREsKKUCxzmhiYqqO7z8AWJdsq47RhMQAAAAASUVORK5CYII=" />
				<span style="margin-left: 10px;">Open The Door</span>
			</a>
	  </nav>
	</header>

	<!-- Begin page content -->
	<main role="main" class="container text-center mt-1">
		<div id="alert-style" class="alert alert-success alert-dismissible fade" role="alert">
			<span id="alert-message"></span>
			<button type="button" class="close" data-dismiss="alert" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
		</div>
		<h2 class="mt-1 display-4" style="display: inline-block;">%name%,&nbsp;</h2>
		<p class="lead" style="display: inline-block;font-size: 1rem;"> la porte est <span id="text_door_status" class="%door_status_color%" style="font-size: 2rem;">%door_status%</span></p>
		<p class="lead mt-2">Vous pouvez la controler à l'aide des boutons ci-dessous :</p>
		<button type="button" class="btn btn-warning btn-lg m-1" onclick="openTheDoor()">Ouvrir</button>
		<button type="button" class="btn btn-info btn-lg m-1">Fermer</button>
		<button type="button" class="btn btn-dark btn-lg m-1">Configurer</button>

	</main>

	<footer class="footer">
		<div class="container">
			<span class="text-muted">Fait par Thomas Hedoux</span>
		</div>
	</footer>

	<!-- JS scripts -->
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js" integrity="sha384-q2kxQ16AaE6UbzuKqyBE9/u/KzioAlnx2maXQHiDX9d4/zp8Ok3f+M7DPm+Ib6IU" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-pQQkAEnwaBkjpqZ8RU1fF1AKtTcHJwFl3pblpTlHXybJjHpMYo79HY3hIi4NKxyj" crossorigin="anonymous"></script>

	<script type="text/javascript">
		$(document).ready(function () {
			// DEBUG
			console.log('READY');
			// TODO loop to get door status
		});

		var IS_DOOR_CLOSED = true;
		var LOCK_IS_SECURED = true;

		function openTheDoor() {
			console.log('Opening the door...');
			setAlert('warning', 'Porte en cours d\'ouverture...');
			// TODO call to open the door (should return only when door is opened) /api/open
			setAlert('success', 'Porte ouverte.');
			IS_DOOR_CLOSED = false;
			setDoorStatus();
			console.log('Door opened.');
		}

		function closeTheDoor() {
			console.log('Closing the door...');
			setAlert('warning', 'Porte en cours de fermeture...');
			// TODO call to close the door (should return only when door is opened) /api/close
			setAlert('success', 'Porte fermée.');
			IS_DOOR_CLOSED = true;
			setDoorStatus();
			console.log('Door closed.');
		}

		function setAlert(type, message) {
			document.getElementById('alert-message').innerText = message;
			document.getElementById('alert-style').setAttribute('class', 'alert alert-dismissible fade show alert-' + type)
		}

		function setDoorStatus(isDoorClosed) {
			if (typeof(isDoorClosed) !== 'boolean') return;
			IS_DOOR_CLOSED = isDoorClosed
			if (IS_DOOR_CLOSED) {
				document.getElementById('text_door_status').innerHTML = '&nbsp;fermée';
				document.getElementById('text_door_status').setAttribute('class', 'c-green');
			}
			else {
				document.getElementById('text_door_status').innerHTML = '&nbsp;ouverte';
				document.getElementById('text_door_status').setAttribute('class', 'c-gold');
			}
		}
	</script>

</body></html>